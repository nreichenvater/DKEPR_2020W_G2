{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport API from './api';\n\nvar AuthService = /*#__PURE__*/function () {\n  function AuthService() {\n    _classCallCheck(this, AuthService);\n\n    this.loggedIn = false;\n  }\n\n  _createClass(AuthService, [{\n    key: \"login\",\n    value: function login(mailInput, passwordInput, callback) {\n      var body = {\n        mail: mailInput,\n        password: passwordInput\n      };\n\n      if (isObj) {\n        body = mailInput;\n      }\n\n      console.log(\"sende login request\", body);\n      API.post(\"/login\", body).then(function (res) {\n        if (res.status === 200) {\n          console.log(res);\n          localStorage.setItem('user', res.data.user.mail);\n          localStorage.setItem('Authorization', res.headers.authorization);\n          localStorage.setItem('userObject', JSON.stringify(res.data.user));\n          callback(res);\n        }\n      })[\"catch\"](function (err) {\n        console.log(err);\n        callback(err);\n      });\n    }\n  }, {\n    key: \"logout\",\n    value: function logout() {\n      localStorage.removeItem('user');\n      localStorage.removeItem('Authorization');\n      localStorage.removeItem('userObject');\n    }\n  }, {\n    key: \"isLoggedIn\",\n    value: function () {\n      var _isLoggedIn = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _this = this;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                console.log(\"checke eingeloggt mit token \" + localStorage.getItem('Authorization'));\n\n                if (!this.hasToken()) {\n                  _context.next = 5;\n                  break;\n                }\n\n                return _context.abrupt(\"return\", new Promise(function (resolve, reject) {\n                  API.get('/user', _this.getHeader()).then(function (res) {\n                    if (res.status === 200) {\n                      resolve(true);\n                    }\n                  })[\"catch\"](function (err) {\n                    console.log(err);\n                    localStorage.removeItem('Authorization');\n                    localStorage.removeItem('user');\n                    resolve(false);\n                  });\n                }));\n\n              case 5:\n                console.log(\"kein token\");\n                return _context.abrupt(\"return\", false);\n\n              case 7:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function isLoggedIn() {\n        return _isLoggedIn.apply(this, arguments);\n      }\n\n      return isLoggedIn;\n    }()\n  }, {\n    key: \"register\",\n    value: function register(mailInput, passwordInput, repeatedPasswordInput, com, successCallback) {\n      console.log(com);\n      API.post(\"/register\", {\n        mail: mailInput,\n        password: passwordInput,\n        passwordConfirm: repeatedPasswordInput,\n        commercial: com\n      }).then(function (res) {\n        if (res.status === 200) {\n          successCallback(res);\n        }\n      })[\"catch\"](function (err) {\n        successCallback(err);\n      });\n    }\n  }, {\n    key: \"hasToken\",\n    value: function hasToken() {\n      if (localStorage.getItem('Authorization') != null) {\n        return true;\n      }\n\n      return false;\n    }\n  }, {\n    key: \"getHeader\",\n    value: function getHeader() {\n      return Object.create({\n        headers: {\n          Authorization: localStorage.getItem('Authorization'),\n          Username: localStorage.getItem('user')\n        }\n      });\n    }\n  }]);\n\n  return AuthService;\n}();\n\nexport default new AuthService();","map":{"version":3,"sources":["C:/Users/Nico/Dropbox/Studium/5. Semester/DKE PR/frontend/components/auth/authservice.js"],"names":["API","AuthService","loggedIn","mailInput","passwordInput","callback","body","mail","password","isObj","console","log","post","then","res","status","localStorage","setItem","data","user","headers","authorization","JSON","stringify","err","removeItem","getItem","hasToken","Promise","resolve","reject","get","getHeader","repeatedPasswordInput","com","successCallback","passwordConfirm","commercial","Object","create","Authorization","Username"],"mappings":"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","sourcesContent":["import API from './api';\r\n\r\nclass AuthService {\r\n    constructor(){\r\n        this.loggedIn = false;\r\n    }\r\n\r\n    login(mailInput, passwordInput, callback){\r\n        let body = {\r\n            mail: mailInput,\r\n            password: passwordInput\r\n        }\r\n        if (isObj) {\r\n            body = mailInput;\r\n        }\r\n        console.log(\"sende login request\", body);\r\n        API.post(`/login`, body)\r\n        .then(res => {\r\n            if(res.status === 200){\r\n                console.log(res);\r\n                localStorage.setItem('user', res.data.user.mail);\r\n                localStorage.setItem('Authorization', res.headers.authorization);\r\n                localStorage.setItem('userObject', JSON.stringify(res.data.user));\r\n                callback(res);\r\n            }\r\n        })\r\n        .catch(err => {\r\n            console.log(err);\r\n            callback(err);\r\n        })\r\n    }\r\n\r\n    logout(){\r\n        localStorage.removeItem('user');\r\n        localStorage.removeItem('Authorization');\r\n        localStorage.removeItem('userObject');\r\n    }\r\n\r\n    async isLoggedIn(){\r\n        console.log(\"checke eingeloggt mit token \" + localStorage.getItem('Authorization'));\r\n        if(this.hasToken()){\r\n            return new Promise((resolve, reject) => {\r\n                API.get('/user', this.getHeader())\r\n                .then(res => {\r\n                    if(res.status === 200){\r\n                        resolve(true);\r\n                    }\r\n                })\r\n                .catch(err => {\r\n                    console.log(err);\r\n                    localStorage.removeItem('Authorization');\r\n                    localStorage.removeItem('user');\r\n                    resolve(false);\r\n                })\r\n            });\r\n        }\r\n        else {\r\n            console.log(\"kein token\");\r\n            return false;\r\n        }\r\n    }\r\n\r\n    register(mailInput, passwordInput, repeatedPasswordInput, com, successCallback){\r\n            console.log(com);\r\n\r\n            API.post(`/register`, {\r\n                mail: mailInput,\r\n                password: passwordInput,\r\n                passwordConfirm: repeatedPasswordInput,\r\n                commercial: com\r\n            })\r\n            .then(res => {\r\n                if(res.status === 200){\r\n                    successCallback(res);\r\n                }\r\n            })\r\n            .catch(err => {\r\n                successCallback(err);\r\n            });\r\n    }\r\n\r\n    hasToken(){\r\n        if(localStorage.getItem('Authorization') != null){\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    getHeader(){\r\n        return Object.create({\r\n            headers: {\r\n                Authorization: localStorage.getItem('Authorization'),\r\n                Username: localStorage.getItem('user')\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\nexport default new AuthService();"]},"metadata":{},"sourceType":"module"}