{"ast":null,"code":"import API from '../../api';\n\nclass AuthService {\n  constructor() {\n    this.loggedIn = false;\n  }\n\n  login(body, callback) {\n    console.log(\"sende login request\", body);\n    API.post(`/login`, body).then(res => {\n      if (res.status === 200) {\n        console.log(res);\n        localStorage.setItem('user', res.data.user);\n        localStorage.setItem('Authorization', res.data.token);\n        callback(res);\n      }\n    }).catch(err => {\n      console.log(err);\n      callback(err);\n    });\n  }\n\n  logout() {\n    localStorage.removeItem('user');\n    localStorage.removeItem('Authorization');\n  }\n\n  async isLoggedIn() {\n    console.log(\"checke eingeloggt mit token \" + localStorage.getItem('Authorization'));\n\n    if (this.hasToken()) {\n      return new Promise((resolve, reject) => {\n        API.get('/user', this.getHeader()).then(res => {\n          if (res.status === 200) {\n            resolve(true);\n          }\n        }).catch(err => {\n          console.log(err);\n          localStorage.removeItem('Authorization');\n          localStorage.removeItem('user');\n          resolve(false);\n        });\n      });\n    } else {\n      console.log(\"kein token\");\n      return false;\n    }\n  }\n\n  register(mailInput, passwordInput, repeatedPasswordInput, successCallback) {\n    API.post(`/register`, {\n      username: mailInput,\n      password: passwordInput,\n      passwordConfirm: repeatedPasswordInput\n    }).then(res => {\n      if (res.status === 200) {\n        successCallback(res);\n      }\n    }).catch(err => {\n      successCallback(err);\n    });\n  }\n\n  hasToken() {\n    if (localStorage.getItem('Authorization') != null) {\n      return true;\n    }\n\n    return false;\n  }\n\n  getHeader() {\n    return Object.create({\n      headers: {\n        Authorization: localStorage.getItem('Authorization'),\n        user: localStorage.getItem('user')\n      }\n    });\n  }\n\n}\n\nexport default new AuthService();","map":{"version":3,"sources":["C:/Users/Nico/Dropbox/Studium/5. Semester/DKE PR/frontend/components/auth/authservice.js"],"names":["API","AuthService","constructor","loggedIn","login","body","callback","console","log","post","then","res","status","localStorage","setItem","data","user","token","catch","err","logout","removeItem","isLoggedIn","getItem","hasToken","Promise","resolve","reject","get","getHeader","register","mailInput","passwordInput","repeatedPasswordInput","successCallback","username","password","passwordConfirm","Object","create","headers","Authorization"],"mappings":"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","sourcesContent":["\r\nimport API from '../../api';\r\n\r\nclass AuthService {\r\n    constructor(){\r\n        this.loggedIn = false;\r\n    }\r\n\r\n    login(body, callback){\r\n        console.log(\"sende login request\", body);\r\n        API.post(`/login`, body)\r\n        .then(res => {\r\n            if(res.status === 200){\r\n                console.log(res);\r\n                localStorage.setItem('user', res.data.user);\r\n                localStorage.setItem('Authorization', res.data.token);\r\n                callback(res);\r\n            }\r\n        })\r\n        .catch(err => {\r\n            console.log(err);\r\n            callback(err);\r\n        })\r\n    }\r\n\r\n    logout(){\r\n        localStorage.removeItem('user');\r\n        localStorage.removeItem('Authorization');\r\n    }\r\n\r\n    async isLoggedIn(){\r\n        console.log(\"checke eingeloggt mit token \" + localStorage.getItem('Authorization'));\r\n        if(this.hasToken()){\r\n            return new Promise((resolve, reject) => {\r\n                API.get('/user', this.getHeader())\r\n                .then(res => {\r\n                    if(res.status === 200){\r\n                        resolve(true);\r\n                    }\r\n                })\r\n                .catch(err => {\r\n                    console.log(err);\r\n                    localStorage.removeItem('Authorization');\r\n                    localStorage.removeItem('user');\r\n                    resolve(false);\r\n                })\r\n            });\r\n        }\r\n        else {\r\n            console.log(\"kein token\");\r\n            return false;\r\n        }\r\n    }\r\n\r\n    register(mailInput, passwordInput, repeatedPasswordInput, successCallback){\r\n\r\n            API.post(`/register`, {\r\n                username: mailInput,\r\n                password: passwordInput,\r\n                passwordConfirm: repeatedPasswordInput\r\n            })\r\n            .then(res => {\r\n                if(res.status === 200){\r\n                    successCallback(res);\r\n                }\r\n            })\r\n            .catch(err => {\r\n                successCallback(err);\r\n            });\r\n    }\r\n\r\n    hasToken(){\r\n        if(localStorage.getItem('Authorization') != null){\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    getHeader(){\r\n        return Object.create({\r\n            headers: {\r\n                Authorization: localStorage.getItem('Authorization'),\r\n                user: localStorage.getItem('user')\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\nexport default new AuthService();"]},"metadata":{},"sourceType":"module"}